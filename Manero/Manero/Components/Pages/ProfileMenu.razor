@using System.Text;
@using System.Text.Json;
@using Manero.Components.Models;
@using Manero.Services;


@page "/ProfileMenu"

<PageTitle>My Profile</PageTitle>

<div>
    <div class="container-fluid px-0">
        <hr class="border-0 border-bottom border-3 mb-0" style="margin-top: -5px; border-color: #DBE3F5;">
    </div>

    <div class="container" style="padding-bottom: 35px; padding-top:5px">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="container d-flex flex-column align-items-center justify-content-center mt-md-5 mt-3">
                    <div class="text-center position-relative">
                        <div class="circle" style="width: 240px; border: 5px solid #DBE3F5; border-radius: 50%;position: relative;">
                            <img src="@photoUrl" class="img-fluid rounded-circle" style="width: 240px; height: 240px; object-fit: cover;">
                            <a href="/EditProfile" class="position-absolute btn-circle btn" style="bottom: 12px; right: 24px; width: 36px; height: 36px; border-radius: 50%; border: none; background-color: #DBE3F5;">
                                <i class="bi bi-pen custom-pen" style="font-size: 16px; margin-left:18px; color: #495057;"></i>
                            </a>
                        </div>
                        <div style="margin-top: 20px;">
                            <strong>Carl Gustaf Folke Hubertus</strong>
                            <br>
                            <p class="text-secondary">kungen@gmail.com</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="container-fluid text-center mt-md-5 mt-1 mb-5">
                    <div class="list-group" style="margin: 0; padding: 0;">
                        <hr class="my-1" style="border-top: 2px solid #ccc; width: 100%; margin: 0;">
                        <button type="button" class="list-group-item list-group-item-action d-flex align-items-center justify-content-start" style="width: 100%; background-color: white; color: black; border-color: white; padding: 8px 12px;" onmouseover="this.style.backgroundColor='#DBE3F5'; this.style.color='#333';" onmouseout="this.style.backgroundColor='white'; this.style.color='black';">
                            <div style="width: 30px; height: 30px; border: 2px solid #DBE3F5; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin-right: 12px;">
                                <i class="bi bi-calendar" style="font-size: 14px; color: #495057;"></i>
                            </div>
                            <h5 class="mb-0" style="margin-left: 12px; font-size: 16px;">Order history</h5>
                            <strong style="margin-left: auto;">></strong>
                        </button>
                        <hr class="my-1" style="border-top: 2px solid #ccc; width: 100%; margin: 0;">
                        <button type="button" class="list-group-item list-group-item-action d-flex align-items-center justify-content-start" style="width: 100%; background-color: white; color: black; border-color: white; padding: 8px 12px;" onmouseover="this.style.backgroundColor='#DBE3F5'; this.style.color='#333';" onmouseout="this.style.backgroundColor='white'; this.style.color='black';">
                            <div style="width: 30px; height: 30px; border: 2px solid #DBE3F5; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin-right: 12px;">
                                <i class="bi bi-credit-card" style="font-size: 14px; color: #495057;"></i>
                            </div>
                            <h5 class="mb-0" style="margin-left: 12px; font-size: 16px;">Payment method</h5>
                            <strong style="margin-left: auto;">></strong>
                        </button>
                        <hr class="my-1" style="border-top: 2px solid #ccc; width: 100%; margin: 0;">
                        <button type="button" class="list-group-item list-group-item-action d-flex align-items-center justify-content-start" style="width: 100%; background-color: white; color: black; border-color: white; padding: 8px 12px;" onmouseover="this.style.backgroundColor='#DBE3F5'; this.style.color='#333';" onmouseout="this.style.backgroundColor='white'; this.style.color='black';">
                            <div style="width: 30px; height: 30px; border: 2px solid #DBE3F5; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin-right: 12px;">
                                <i class="bi bi-geo-alt" style="font-size: 14px; color: #495057;"></i>
                            </div>
                            <h5 class="mb-0" style="margin-left: 12px; font-size: 16px;">My address</h5>
                            <strong style="margin-left: auto;">></strong>
                        </button>
                        <hr class="my-1" style="border-top: 2px solid #ccc; width: 100%; margin: 0;">
                        <button type="button" class="list-group-item list-group-item-action d-flex align-items-center justify-content-start" style="width: 100%; background-color: white; color: black; border-color: white; padding: 8px 12px;" onmouseover="this.style.backgroundColor='#DBE3F5'; this.style.color='#333';" onmouseout="this.style.backgroundColor='white'; this.style.color='black';">
                            <div style="width: 30px; height: 30px; border: 2px solid #DBE3F5; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin-right: 12px;">
                                <i class="bi bi-gift" style="font-size: 14px; color: #495057;"></i>
                            </div>
                            <h5 class="mb-0" style="margin-left: 12px; font-size: 16px;">My promocodes</h5>
                            <strong style="margin-left: auto;">></strong>
                        </button>
                        <hr class="my-1" style="border-top: 2px solid #ccc; width: 100%; margin: 0;">
                        <button type="button" class="list-group-item list-group-item-action d-flex align-items-center justify-content-start" style="width: 100%; background-color: white; color: black; border-color: white; padding: 8px 12px;" onmouseover="this.style.backgroundColor='#DBE3F5'; this.style.color='#333';" onmouseout="this.style.backgroundColor='white'; this.style.color='black';">
                            <div style="width: 30px; height: 30px; border: 2px solid #DBE3F5; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin-right: 12px;">
                                <i class="bi bi-box-arrow-right" style="font-size: 14px; color: #495057;"></i>
                            </div>
                            <h5 class="mb-0" style="margin-left: 12px; font-size: 16px;">Sign out</h5>
                        </button>
                        <hr class="my-1" style="border-top: 2px solid #ccc; width: 100%; margin: 0;">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


@code {
    private string photoUrl;
    private PhotoService _photoService { get; set; }

    protected override async Task OnInitializedAsync()
    {
        _photoService = new PhotoService(new HttpClient());
        await GetUserPhoto();
        // await GetUserInfo();
    }

    private async Task GetUserPhoto()
    {
        try
        {
            int userId = 1;
            photoUrl = await _photoService.GetUserPhotoUrlAsync(userId);
        }
        catch (Exception ex)
        {
            Console.WriteLine($"An error occurred: {ex.Message}");
            photoUrl = "error.jpg";
        }
    }
}

